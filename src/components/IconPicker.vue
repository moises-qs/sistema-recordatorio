<template>
  <div class="relative" ref="root">
    <button type="button" @click="show = !show" class="flex items-center border rounded px-2 py-1 bg-white min-w-[90px]">
      <span class="text-xl mr-1">{{ modelValue || '‚ùì' }}</span>
      <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>
    <div v-if="show" class="absolute z-10 mt-1 bg-white border rounded shadow-lg p-2 grid grid-cols-10 gap-2 max-h-80 w-[420px] overflow-y-auto">
      <button v-for="icon in icons" :key="icon" @click="select(icon)" class="text-xl hover:bg-gray-100 rounded p-1">
        {{ icon }}
      </button>
    </div>
  </div>
</template>

<script setup>
import { ref, watch, onMounted, onBeforeUnmount } from 'vue';
const props = defineProps({
  modelValue: String
});
const emit = defineEmits(['update:modelValue']);
const show = ref(false);
const root = ref(null);
const icons = [
  'üìã','üìö','üìù','üé§','üë•','üìÖ','‚è∞','üìÜ','üóÇÔ∏è','üßë‚Äçüè´','üè´','üìñ','üß™','üß¨','üß†','üí°','üñäÔ∏è','üóíÔ∏è','üìà','üìä','üóìÔ∏è','üìé','üìå','üì¢','üîî','‚≠ê','‚úÖ','‚ùó','‚ö†Ô∏è','üî¨','üßë‚Äçüíª','üíª','üì±','üñ•Ô∏è','üßë‚Äçüéì','üéì','üèÜ','ü•á','ü•à','ü•â','üéØ','üé≤','üéÆ','üéº','üé®','üß©','üß∏','üéÅ','üéÇ','üçé','üçï','üçî','üçü','üç©','üç™','üç´','üçø','üç∞','üç¶','üç≠','üçâ','üçá','üçì','üçí','üçë','üçç','ü•ù','ü•ë','ü•¶','ü•ï','üåΩ','üå∂Ô∏è','ü•í','ü•¨','ü•î','üç†','üç§','üç£','üç±','üçõ','üçú','üç≤','üç•','üçô','üçö','üçò','üç¢','üç°','üçß','üç®','üç¶','ü•ß','üç∞','üéÇ','üçÆ','üç≠','üç¨','üç´','üçø','üç©','üç™','ü•†','ü•Æ','üçØ','üçº','ü•õ','‚òï','üçµ','üç∂','üç∫','üçª','ü•Ç','üç∑','ü•É','üç∏','üçπ','üçæ','ü•Ñ','üç¥','üçΩÔ∏è','ü•£','ü•°','ü•¢','üßÇ','ü•´','üç±','üç≤','üçõ','üçú','üçù','üç†','üç¢','üç£','üç§','üç•','üç°','ü•ü','ü•†','ü•°','ü¶™','üç¶','üçß','üç®','üç©','üç™','üéÉ','üéÑ','üéÜ','üéá','‚ú®','üéà','üéâ','üéä','üéã','üéç','üéé','üéè','üéê','üéë','üßß','üéÄ','üéÅ','üé´','üéüÔ∏è','üéóÔ∏è','üèÖ','üéñÔ∏è','ü•á','ü•à','ü•â','üèÜ','üèµÔ∏è','üéóÔ∏è','üé´','üéüÔ∏è','üé™','ü§π‚Äç‚ôÇÔ∏è','ü§π‚Äç‚ôÄÔ∏è','üé≠','ü©∞','üé®','üé¨','üé§','üéß','üéº','üéπ','ü•Å','üé∑','üé∫','üé∏','ü™ï','üéª','üé≤','‚ôüÔ∏è','üéØ','üé≥','üéÆ','üé∞','üß©','üß∏','ü™Å','ü™Ä','ü™É','ü™Ñ','ü™Ö','ü™Ü','ü™ê','üåü','üí´','‚ú®','üî•','üåà','‚òÄÔ∏è','üå§Ô∏è','‚õÖ','üå•Ô∏è','üå¶Ô∏è','üåßÔ∏è','‚õàÔ∏è','üå©Ô∏è','üå®Ô∏è','‚ùÑÔ∏è','‚òÉÔ∏è','‚õÑ','üå¨Ô∏è','üí®','üå™Ô∏è','üå´Ô∏è','üåä','üíß','üí¶','‚òî','ü¶ã','üêù','üêû','üêå','üêõ','ü¶ó','üï∑Ô∏è','ü¶Ç','üê¢','üêç','ü¶é','ü¶ñ','ü¶ï','üêô','ü¶ë','ü¶ê','ü¶û','ü¶Ä','üê°','üê†','üêü','üê¨','üê≥','üêã','ü¶à','üêä','üêÖ','üêÜ','ü¶ì','ü¶ç','ü¶ß','üêò','ü¶õ','ü¶è','üê™','üê´','ü¶í','ü¶ò','ü¶¨','üêÉ','üêÇ','üêÑ','üêé','üêñ','üêè','üêë','ü¶ô','üêê','ü¶å','üêï','üê©','ü¶Æ','üêï‚Äçü¶∫','üêà','üêà‚Äç‚¨õ','ü¶§','ü¶ú','ü¶¢','ü¶©','üïäÔ∏è','üêá','ü¶ù','ü¶®','ü¶°','ü¶¶','ü¶•','üêÅ','üêÄ','üêøÔ∏è','ü¶î'];

function select(icon) {
  emit('update:modelValue', icon);
  show.value = false;
}

function handleClickOutside(event) {
  if (root.value && !root.value.contains(event.target)) {
    show.value = false;
  }
}

onMounted(() => {
  document.addEventListener('mousedown', handleClickOutside);
});
onBeforeUnmount(() => {
  document.removeEventListener('mousedown', handleClickOutside);
});
</script>

<style scoped>
.min-w-\[90px\] { min-width: 90px; }
.w-\[420px\] { width: 420px; }
</style>
